<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCBDC Transaction Processor: cbdc::coordinator::distributed_tx Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenCBDC Transaction Processor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classcbdc_1_1coordinator_1_1distributed__tx.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">cbdc::coordinator::distributed_tx Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class to manage a single distributed transaction (dtx) batch between shards.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="distributed__tx_8hpp_source.html">distributed_tx.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a71d5d6ecc78a28643c788acad88d506f" id="r_a71d5d6ecc78a28643c788acad88d506f"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71d5d6ecc78a28643c788acad88d506f">dtx_state</a> { <br />
&#160;&#160;<a class="el" href="#a71d5d6ecc78a28643c788acad88d506faea2b2676c28c0db26d39331a336c6b92">start</a>
, <a class="el" href="#a71d5d6ecc78a28643c788acad88d506fa0ee63ccea22773b7b711a299adc32792">prepare</a>
, <a class="el" href="#a71d5d6ecc78a28643c788acad88d506fafffca4d67ea0a788813031b8bbc3b329">commit</a>
, <a class="el" href="#a71d5d6ecc78a28643c788acad88d506fa70f68bb2f748b85de6526bfe236ea1e9">discard</a>
, <br />
&#160;&#160;<a class="el" href="#a71d5d6ecc78a28643c788acad88d506fa6b2ded51d81a4403d8a4bd25fa1e57ee">done</a>
, <a class="el" href="#a71d5d6ecc78a28643c788acad88d506fa26934eb377001f66e37289a5c93fe284">failed</a>
<br />
 }</td></tr>
<tr class="separator:a71d5d6ecc78a28643c788acad88d506f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a185336cd9e7170ef16b0ea1dac791228" id="r_a185336cd9e7170ef16b0ea1dac791228"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a185336cd9e7170ef16b0ea1dac791228">discard_cb_t</a> = std::function&lt;bool(const <a class="el" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a>&amp;)&gt;</td></tr>
<tr class="separator:a185336cd9e7170ef16b0ea1dac791228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae84506a65e497c4984de423c4a5a905c" id="r_ae84506a65e497c4984de423c4a5a905c"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae84506a65e497c4984de423c4a5a905c">done_cb_t</a> = std::function&lt;bool(const <a class="el" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a>&amp;)&gt;</td></tr>
<tr class="separator:ae84506a65e497c4984de423c4a5a905c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac450c7f6bfb87a2ff61b0fbcf4973662" id="r_ac450c7f6bfb87a2ff61b0fbcf4973662"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac450c7f6bfb87a2ff61b0fbcf4973662">commit_cb_t</a></td></tr>
<tr class="separator:ac450c7f6bfb87a2ff61b0fbcf4973662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab224ce2a5e57c82789c01d4ff7fe23d0" id="r_ab224ce2a5e57c82789c01d4ff7fe23d0"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab224ce2a5e57c82789c01d4ff7fe23d0">prepare_cb_t</a></td></tr>
<tr class="separator:ab224ce2a5e57c82789c01d4ff7fe23d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae52f54b5444e7448258aa9a49670cd90" id="r_ae52f54b5444e7448258aa9a49670cd90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae52f54b5444e7448258aa9a49670cd90">distributed_tx</a> (const <a class="el" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a> &amp;dtx_id, std::vector&lt; std::shared_ptr&lt; <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">locking_shard::interface</a> &gt; &gt; shards, std::shared_ptr&lt; <a class="el" href="classcbdc_1_1logging_1_1log.html">logging::log</a> &gt; logger)</td></tr>
<tr class="memdesc:ae52f54b5444e7448258aa9a49670cd90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new transaction coordinator instance.  <br /></td></tr>
<tr class="separator:ae52f54b5444e7448258aa9a49670cd90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e5669d96357d7ef4cbe31445d2e3585" id="r_a4e5669d96357d7ef4cbe31445d2e3585"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e5669d96357d7ef4cbe31445d2e3585">execute</a> () -&gt; std::optional&lt; std::vector&lt; bool &gt; &gt;</td></tr>
<tr class="memdesc:a4e5669d96357d7ef4cbe31445d2e3585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the dtx batch to completion or failure, either from start, or an intermediate state if one of the recover functions were used.  <br /></td></tr>
<tr class="separator:a4e5669d96357d7ef4cbe31445d2e3585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cc25823855f3a4c89162e6ee51990e8" id="r_a8cc25823855f3a4c89162e6ee51990e8"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8cc25823855f3a4c89162e6ee51990e8">add_tx</a> (const <a class="el" href="structcbdc_1_1transaction_1_1compact__tx.html">transaction::compact_tx</a> &amp;tx) -&gt; size_t</td></tr>
<tr class="memdesc:a8cc25823855f3a4c89162e6ee51990e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a TX to the batch managed by this coordinator and dtx ID.  <br /></td></tr>
<tr class="separator:a8cc25823855f3a4c89162e6ee51990e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a370b10ffcf21703d8a268e94c0941802" id="r_a370b10ffcf21703d8a268e94c0941802"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a370b10ffcf21703d8a268e94c0941802">get_id</a> () const -&gt; <a class="el" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a></td></tr>
<tr class="memdesc:a370b10ffcf21703d8a268e94c0941802"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the dtx ID associated with this coordinator instance.  <br /></td></tr>
<tr class="separator:a370b10ffcf21703d8a268e94c0941802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae56a2e9f8aa05babe02afbb44b39353d" id="r_ae56a2e9f8aa05babe02afbb44b39353d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae56a2e9f8aa05babe02afbb44b39353d">set_prepare_cb</a> (const <a class="el" href="#ab224ce2a5e57c82789c01d4ff7fe23d0">prepare_cb_t</a> &amp;cb)</td></tr>
<tr class="memdesc:ae56a2e9f8aa05babe02afbb44b39353d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a callback to be called before starting the prepare phase of the dtx.  <br /></td></tr>
<tr class="separator:ae56a2e9f8aa05babe02afbb44b39353d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a8d74aa17377f1d72b0cb33b2198020" id="r_a1a8d74aa17377f1d72b0cb33b2198020"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a8d74aa17377f1d72b0cb33b2198020">set_commit_cb</a> (const <a class="el" href="#ac450c7f6bfb87a2ff61b0fbcf4973662">commit_cb_t</a> &amp;cb)</td></tr>
<tr class="memdesc:a1a8d74aa17377f1d72b0cb33b2198020"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a callback to be called before starting the commit phase of the dtx.  <br /></td></tr>
<tr class="separator:a1a8d74aa17377f1d72b0cb33b2198020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52f1d0595389e11130e2d65e6d5e9264" id="r_a52f1d0595389e11130e2d65e6d5e9264"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a52f1d0595389e11130e2d65e6d5e9264">set_discard_cb</a> (const <a class="el" href="#a185336cd9e7170ef16b0ea1dac791228">discard_cb_t</a> &amp;cb)</td></tr>
<tr class="memdesc:a52f1d0595389e11130e2d65e6d5e9264"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a callback to be called before the discard phase of the dtx is started.  <br /></td></tr>
<tr class="separator:a52f1d0595389e11130e2d65e6d5e9264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af79e372c1ca85742f1a40122bcd5d105" id="r_af79e372c1ca85742f1a40122bcd5d105"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af79e372c1ca85742f1a40122bcd5d105">set_done_cb</a> (const <a class="el" href="#ae84506a65e497c4984de423c4a5a905c">done_cb_t</a> &amp;cb)</td></tr>
<tr class="memdesc:af79e372c1ca85742f1a40122bcd5d105"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a callback to be called before the done phase of the dtx is started.  <br /></td></tr>
<tr class="separator:af79e372c1ca85742f1a40122bcd5d105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa8559dc7ccbbc26cf65c5a2c80843b7" id="r_aaa8559dc7ccbbc26cf65c5a2c80843b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa8559dc7ccbbc26cf65c5a2c80843b7">recover_prepare</a> (const std::vector&lt; <a class="el" href="structcbdc_1_1transaction_1_1compact__tx.html">transaction::compact_tx</a> &gt; &amp;txs)</td></tr>
<tr class="memdesc:aaa8559dc7ccbbc26cf65c5a2c80843b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the state of the dtx to prepare and re-adds all the txs included in the batch.  <br /></td></tr>
<tr class="separator:aaa8559dc7ccbbc26cf65c5a2c80843b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a445d950e597d19b548c3d6028b3b5fa7" id="r_a445d950e597d19b548c3d6028b3b5fa7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a445d950e597d19b548c3d6028b3b5fa7">recover_commit</a> (const std::vector&lt; bool &gt; &amp;complete_txs, const std::vector&lt; std::vector&lt; uint64_t &gt; &gt; &amp;tx_idxs)</td></tr>
<tr class="memdesc:a445d950e597d19b548c3d6028b3b5fa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the state of the dtx to commit and sets the state from the end of the prepare phase so that <a class="el" href="#a4e5669d96357d7ef4cbe31445d2e3585" title="Executes the dtx batch to completion or failure, either from start, or an intermediate state if one o...">execute()</a> will continue the commit phase.  <br /></td></tr>
<tr class="separator:a445d950e597d19b548c3d6028b3b5fa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a836830df9666d8d640ce87d9fec4e7fb" id="r_a836830df9666d8d640ce87d9fec4e7fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a836830df9666d8d640ce87d9fec4e7fb">recover_discard</a> ()</td></tr>
<tr class="memdesc:a836830df9666d8d640ce87d9fec4e7fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the state of the dtx to discard so that <a class="el" href="#a4e5669d96357d7ef4cbe31445d2e3585" title="Executes the dtx batch to completion or failure, either from start, or an intermediate state if one o...">execute()</a> will start from the discard phase.  <br /></td></tr>
<tr class="separator:a836830df9666d8d640ce87d9fec4e7fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230f62211c8cb684408cf1614874d28f" id="r_a230f62211c8cb684408cf1614874d28f"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a230f62211c8cb684408cf1614874d28f">size</a> () const -&gt; size_t</td></tr>
<tr class="memdesc:a230f62211c8cb684408cf1614874d28f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of transactions in the dtx.  <br /></td></tr>
<tr class="separator:a230f62211c8cb684408cf1614874d28f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add273c30ab3ea59ba17e662045eb2a3e" id="r_add273c30ab3ea59ba17e662045eb2a3e"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add273c30ab3ea59ba17e662045eb2a3e">get_state</a> () const -&gt; <a class="el" href="#a71d5d6ecc78a28643c788acad88d506f">dtx_state</a></td></tr>
<tr class="memdesc:add273c30ab3ea59ba17e662045eb2a3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current state of the dtx.  <br /></td></tr>
<tr class="separator:add273c30ab3ea59ba17e662045eb2a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to manage a single distributed transaction (dtx) batch between shards. </p>
<p>Capable of recovering previously failed dtxs and sharing the results of each dtx phase with callback functions (usually for replication). </p>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8hpp_source.html#l00023">23</a> of file <a class="el" href="distributed__tx_8hpp_source.html">distributed_tx.hpp</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ac450c7f6bfb87a2ff61b0fbcf4973662" name="ac450c7f6bfb87a2ff61b0fbcf4973662"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac450c7f6bfb87a2ff61b0fbcf4973662">&#9670;&#160;</a></span>commit_cb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#ac450c7f6bfb87a2ff61b0fbcf4973662">cbdc::coordinator::distributed_tx::commit_cb_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"> std::function&lt;bool(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a>&amp;,</div>
<div class="line">                                 <span class="keyword">const</span> std::vector&lt;bool&gt;&amp;,</div>
<div class="line">                                 <span class="keyword">const</span> std::vector&lt;std::vector&lt;uint64_t&gt;&gt;&amp;)&gt;</div>
<div class="ttc" id="anamespacecbdc_html_a43003e7fa06302c4269e2211d9d4a528"><div class="ttname"><a href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">cbdc::hash_t</a></div><div class="ttdeci">std::array&lt; unsigned char, cbdc::hash_size &gt; hash_t</div><div class="ttdoc">SHA256 hash container.</div><div class="ttdef"><b>Definition</b> <a href="util_2common_2hash_8hpp_source.html#l00019">util/common/hash.hpp:19</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="distributed__tx_8hpp_source.html#l00055">55</a> of file <a class="el" href="distributed__tx_8hpp_source.html">distributed_tx.hpp</a>.</p>

</div>
</div>
<a id="a185336cd9e7170ef16b0ea1dac791228" name="a185336cd9e7170ef16b0ea1dac791228"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a185336cd9e7170ef16b0ea1dac791228">&#9670;&#160;</a></span>discard_cb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#a185336cd9e7170ef16b0ea1dac791228">cbdc::coordinator::distributed_tx::discard_cb_t</a> = std::function&lt;bool(const <a class="el" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a>&amp;)&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributed__tx_8hpp_source.html#l00053">53</a> of file <a class="el" href="distributed__tx_8hpp_source.html">distributed_tx.hpp</a>.</p>

</div>
</div>
<a id="ae84506a65e497c4984de423c4a5a905c" name="ae84506a65e497c4984de423c4a5a905c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae84506a65e497c4984de423c4a5a905c">&#9670;&#160;</a></span>done_cb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#ae84506a65e497c4984de423c4a5a905c">cbdc::coordinator::distributed_tx::done_cb_t</a> = std::function&lt;bool(const <a class="el" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a>&amp;)&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="distributed__tx_8hpp_source.html#l00054">54</a> of file <a class="el" href="distributed__tx_8hpp_source.html">distributed_tx.hpp</a>.</p>

</div>
</div>
<a id="ab224ce2a5e57c82789c01d4ff7fe23d0" name="ab224ce2a5e57c82789c01d4ff7fe23d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab224ce2a5e57c82789c01d4ff7fe23d0">&#9670;&#160;</a></span>prepare_cb_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#ab224ce2a5e57c82789c01d4ff7fe23d0">cbdc::coordinator::distributed_tx::prepare_cb_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"> std::function&lt;bool(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a>&amp;,</div>
<div class="line">                                 <span class="keyword">const</span> std::vector&lt;transaction::compact_tx&gt;&amp;)&gt;</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="distributed__tx_8hpp_source.html#l00058">58</a> of file <a class="el" href="distributed__tx_8hpp_source.html">distributed_tx.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a71d5d6ecc78a28643c788acad88d506f" name="a71d5d6ecc78a28643c788acad88d506f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71d5d6ecc78a28643c788acad88d506f">&#9670;&#160;</a></span>dtx_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="#a71d5d6ecc78a28643c788acad88d506f">cbdc::coordinator::distributed_tx::dtx_state</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a71d5d6ecc78a28643c788acad88d506faea2b2676c28c0db26d39331a336c6b92" name="a71d5d6ecc78a28643c788acad88d506faea2b2676c28c0db26d39331a336c6b92"></a>start&#160;</td><td class="fielddoc"><p>dtx initial state, no action has been performed yet </p>
</td></tr>
<tr><td class="fieldname"><a id="a71d5d6ecc78a28643c788acad88d506fa0ee63ccea22773b7b711a299adc32792" name="a71d5d6ecc78a28643c788acad88d506fa0ee63ccea22773b7b711a299adc32792"></a>prepare&#160;</td><td class="fielddoc"><p>dtx is calling prepare on shards </p>
</td></tr>
<tr><td class="fieldname"><a id="a71d5d6ecc78a28643c788acad88d506fafffca4d67ea0a788813031b8bbc3b329" name="a71d5d6ecc78a28643c788acad88d506fafffca4d67ea0a788813031b8bbc3b329"></a>commit&#160;</td><td class="fielddoc"><p>dtx is calling commit on shards </p>
</td></tr>
<tr><td class="fieldname"><a id="a71d5d6ecc78a28643c788acad88d506fa70f68bb2f748b85de6526bfe236ea1e9" name="a71d5d6ecc78a28643c788acad88d506fa70f68bb2f748b85de6526bfe236ea1e9"></a>discard&#160;</td><td class="fielddoc"><p>dtx is calling discard on shards </p>
</td></tr>
<tr><td class="fieldname"><a id="a71d5d6ecc78a28643c788acad88d506fa6b2ded51d81a4403d8a4bd25fa1e57ee" name="a71d5d6ecc78a28643c788acad88d506fa6b2ded51d81a4403d8a4bd25fa1e57ee"></a>done&#160;</td><td class="fielddoc"><p>dtx has completed fully </p>
</td></tr>
<tr><td class="fieldname"><a id="a71d5d6ecc78a28643c788acad88d506fa26934eb377001f66e37289a5c93fe284" name="a71d5d6ecc78a28643c788acad88d506fa26934eb377001f66e37289a5c93fe284"></a>failed&#160;</td><td class="fielddoc"><p>dtx was interrupted and needs recovery. </p>
<p>Shards will be left somewhere between states. For example, if the prepare phase has completed and the coordinator has started the commit phase, some shards will be committed and others could still be in the prepare phase. The dtx will need to be recovered from the start of the commit phase to ensure all shards are committed. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8hpp_source.html#l00121">121</a> of file <a class="el" href="distributed__tx_8hpp_source.html">distributed_tx.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae52f54b5444e7448258aa9a49670cd90" name="ae52f54b5444e7448258aa9a49670cd90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae52f54b5444e7448258aa9a49670cd90">&#9670;&#160;</a></span>distributed_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::coordinator::distributed_tx::distributed_tx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>dtx_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::shared_ptr&lt; <a class="el" href="classcbdc_1_1locking__shard_1_1interface.html">locking_shard::interface</a> &gt; &gt;</td>          <td class="paramname"><span class="paramname"><em>shards</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcbdc_1_1logging_1_1log.html">logging::log</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>logger</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a new transaction coordinator instance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dtx_id</td><td>dtx ID for this transaction batch </td></tr>
    <tr><td class="paramname">shards</td><td>vector of locking shards that will participate in the dtx. If recovering a previous dtx, the list must refer to the same shards in the same order. </td></tr>
    <tr><td class="paramname">logger</td><td>logger for messages. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00011">11</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8cc25823855f3a4c89162e6ee51990e8" name="a8cc25823855f3a4c89162e6ee51990e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cc25823855f3a4c89162e6ee51990e8">&#9670;&#160;</a></span>add_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::coordinator::distributed_tx::add_tx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcbdc_1_1transaction_1_1compact__tx.html">transaction::compact_tx</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>tx</em></span></td><td>)</td>
          <td> -&gt; size_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a TX to the batch managed by this coordinator and dtx ID. </p>
<p>Should not be used after calling <a class="el" href="#a4e5669d96357d7ef4cbe31445d2e3585" title="Executes the dtx batch to completion or failure, either from start, or an intermediate state if one o...">execute()</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tx</td><td>compact transaction to add </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the index of the transaction withing the dtx batch </dd></dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00147">147</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="distributed__tx_8cpp_source.html#l00238">recover_prepare()</a>.</p>

</div>
</div>
<a id="a4e5669d96357d7ef4cbe31445d2e3585" name="a4e5669d96357d7ef4cbe31445d2e3585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e5669d96357d7ef4cbe31445d2e3585">&#9670;&#160;</a></span>execute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::coordinator::distributed_tx::execute </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> -&gt; std::optional&lt;std::vector&lt;bool&gt;&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">nodiscard</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Executes the dtx batch to completion or failure, either from start, or an intermediate state if one of the recover functions were used. </p>
<dl class="section return"><dt>Returns</dt><dd>empty optional if the dtx failed, or a vector of flags indicating which constituent transactions settled and which were rolled back by the transaction's index in the batch. </dd></dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00109">109</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

<p class="reference">References <a class="el" href="util_2common_2hash_8cpp_source.html#l00015">cbdc::to_string()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1coordinator_1_1distributed__tx_a4e5669d96357d7ef4cbe31445d2e3585_cgraph.png" border="0" usemap="#aclasscbdc_1_1coordinator_1_1distributed__tx_a4e5669d96357d7ef4cbe31445d2e3585_cgraph" alt=""/></div>
<map name="aclasscbdc_1_1coordinator_1_1distributed__tx_a4e5669d96357d7ef4cbe31445d2e3585_cgraph" id="aclasscbdc_1_1coordinator_1_1distributed__tx_a4e5669d96357d7ef4cbe31445d2e3585_cgraph">
<area shape="rect" title="Executes the dtx batch to completion or failure, either from start, or an intermediate state if one o..." alt="" coords="5,5,155,46"/>
<area shape="rect" href="namespacecbdc.html#aeca0663c5237402736e3127369854cb5" title="Converts a hash to a hexadecimal string." alt="" coords="203,13,308,38"/>
<area shape="poly" title=" " alt="" coords="155,23,187,23,187,28,155,28"/>
</map>
</div>

</div>
</div>
<a id="a370b10ffcf21703d8a268e94c0941802" name="a370b10ffcf21703d8a268e94c0941802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a370b10ffcf21703d8a268e94c0941802">&#9670;&#160;</a></span>get_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::coordinator::distributed_tx::get_id </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const -&gt; <a class="el" href="namespacecbdc.html#a43003e7fa06302c4269e2211d9d4a528">hash_t</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">nodiscard</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the dtx ID associated with this coordinator instance. </p>
<dl class="section return"><dt>Returns</dt><dd>dtx ID for this coordinator </dd></dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00218">218</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

</div>
</div>
<a id="add273c30ab3ea59ba17e662045eb2a3e" name="add273c30ab3ea59ba17e662045eb2a3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add273c30ab3ea59ba17e662045eb2a3e">&#9670;&#160;</a></span>get_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::coordinator::distributed_tx::get_state </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const -&gt; <a class="el" href="#a71d5d6ecc78a28643c788acad88d506f">dtx_state</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">nodiscard</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the current state of the dtx. </p>
<dl class="section return"><dt>Returns</dt><dd>state of the dtx </dd></dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00262">262</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

</div>
</div>
<a id="a445d950e597d19b548c3d6028b3b5fa7" name="a445d950e597d19b548c3d6028b3b5fa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a445d950e597d19b548c3d6028b3b5fa7">&#9670;&#160;</a></span>recover_commit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::coordinator::distributed_tx::recover_commit </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>complete_txs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; uint64_t &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tx_idxs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the state of the dtx to commit and sets the state from the end of the prepare phase so that <a class="el" href="#a4e5669d96357d7ef4cbe31445d2e3585" title="Executes the dtx batch to completion or failure, either from start, or an intermediate state if one o...">execute()</a> will continue the commit phase. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">complete_txs</td><td>vector of flags indicating which transactions in the batch to complete or cancel. The return value from the prepare phase. </td></tr>
    <tr><td class="paramname">tx_idxs</td><td>vector for each shard indicating which txs in the complete_txs vector apply to each shard. Generated before the prepare phase. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00246">246</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

<p class="reference">References <a class="el" href="#a71d5d6ecc78a28643c788acad88d506fafffca4d67ea0a788813031b8bbc3b329">commit</a>.</p>

</div>
</div>
<a id="a836830df9666d8d640ce87d9fec4e7fb" name="a836830df9666d8d640ce87d9fec4e7fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a836830df9666d8d640ce87d9fec4e7fb">&#9670;&#160;</a></span>recover_discard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::coordinator::distributed_tx::recover_discard </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the state of the dtx to discard so that <a class="el" href="#a4e5669d96357d7ef4cbe31445d2e3585" title="Executes the dtx batch to completion or failure, either from start, or an intermediate state if one o...">execute()</a> will start from the discard phase. </p>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00254">254</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

<p class="reference">References <a class="el" href="#a71d5d6ecc78a28643c788acad88d506fa70f68bb2f748b85de6526bfe236ea1e9">discard</a>.</p>

</div>
</div>
<a id="aaa8559dc7ccbbc26cf65c5a2c80843b7" name="aaa8559dc7ccbbc26cf65c5a2c80843b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa8559dc7ccbbc26cf65c5a2c80843b7">&#9670;&#160;</a></span>recover_prepare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::coordinator::distributed_tx::recover_prepare </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structcbdc_1_1transaction_1_1compact__tx.html">transaction::compact_tx</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>txs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the state of the dtx to prepare and re-adds all the txs included in the batch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">txs</td><td>list of txs included in the dtx batch </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00238">238</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

<p class="reference">References <a class="el" href="distributed__tx_8cpp_source.html#l00147">add_tx()</a>, and <a class="el" href="#a71d5d6ecc78a28643c788acad88d506fa0ee63ccea22773b7b711a299adc32792">prepare</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1coordinator_1_1distributed__tx_aaa8559dc7ccbbc26cf65c5a2c80843b7_cgraph.png" border="0" usemap="#aclasscbdc_1_1coordinator_1_1distributed__tx_aaa8559dc7ccbbc26cf65c5a2c80843b7_cgraph" alt=""/></div>
<map name="aclasscbdc_1_1coordinator_1_1distributed__tx_aaa8559dc7ccbbc26cf65c5a2c80843b7_cgraph" id="aclasscbdc_1_1coordinator_1_1distributed__tx_aaa8559dc7ccbbc26cf65c5a2c80843b7_cgraph">
<area shape="rect" title="Sets the state of the dtx to prepare and re&#45;adds all the txs included in the batch." alt="" coords="5,5,153,61"/>
<area shape="rect" href="classcbdc_1_1coordinator_1_1distributed__tx.html#a8cc25823855f3a4c89162e6ee51990e8" title="Adds a TX to the batch managed by this coordinator and dtx ID." alt="" coords="201,13,343,54"/>
<area shape="poly" title=" " alt="" coords="153,30,186,30,186,36,153,36"/>
</map>
</div>

</div>
</div>
<a id="a1a8d74aa17377f1d72b0cb33b2198020" name="a1a8d74aa17377f1d72b0cb33b2198020"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a8d74aa17377f1d72b0cb33b2198020">&#9670;&#160;</a></span>set_commit_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::coordinator::distributed_tx::set_commit_cb </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="#ac450c7f6bfb87a2ff61b0fbcf4973662">commit_cb_t</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>cb</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a callback to be called before starting the commit phase of the dtx. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>callback function taking the dtx ID, a vector of flags indicating which transactions to complete, and a vector of vectors indicating the indexes for each shard included in the complete transactions vector. Returns true if the callback operation was successful. Returning false halts further execution of the dtx and sets the dtx state to failed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00226">226</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

</div>
</div>
<a id="a52f1d0595389e11130e2d65e6d5e9264" name="a52f1d0595389e11130e2d65e6d5e9264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52f1d0595389e11130e2d65e6d5e9264">&#9670;&#160;</a></span>set_discard_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::coordinator::distributed_tx::set_discard_cb </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="#a185336cd9e7170ef16b0ea1dac791228">discard_cb_t</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>cb</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a callback to be called before the discard phase of the dtx is started. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>callback function taking the dtx ID as argument and returning true if the callback operation was successful. Returning false halts further execution of the dtx and sets the dtx state to failed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00230">230</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

</div>
</div>
<a id="af79e372c1ca85742f1a40122bcd5d105" name="af79e372c1ca85742f1a40122bcd5d105"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af79e372c1ca85742f1a40122bcd5d105">&#9670;&#160;</a></span>set_done_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::coordinator::distributed_tx::set_done_cb </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="#ae84506a65e497c4984de423c4a5a905c">done_cb_t</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>cb</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a callback to be called before the done phase of the dtx is started. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>callback function taking the dtx ID as argument and returning true if the callback operation was successful. Returning false halts further execution of the dtx and sets the dtx state to failed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00234">234</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

</div>
</div>
<a id="ae56a2e9f8aa05babe02afbb44b39353d" name="ae56a2e9f8aa05babe02afbb44b39353d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae56a2e9f8aa05babe02afbb44b39353d">&#9670;&#160;</a></span>set_prepare_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::coordinator::distributed_tx::set_prepare_cb </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="#ab224ce2a5e57c82789c01d4ff7fe23d0">prepare_cb_t</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>cb</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a callback to be called before starting the prepare phase of the dtx. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>callback function taking the dtx ID and a vector of transactions in the dtx. Returns true if the callback operation was successful. Returning false halts further execution of the dtx and sets the dtx state to failed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00222">222</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

</div>
</div>
<a id="a230f62211c8cb684408cf1614874d28f" name="a230f62211c8cb684408cf1614874d28f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a230f62211c8cb684408cf1614874d28f">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::coordinator::distributed_tx::size </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const -&gt; size_t</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">nodiscard</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the number of transactions in the dtx. </p>
<dl class="section return"><dt>Returns</dt><dd>number of transactions in the batch </dd></dl>

<p class="definition">Definition at line <a class="el" href="distributed__tx_8cpp_source.html#l00258">258</a> of file <a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="distributed__tx_8hpp_source.html">distributed_tx.hpp</a></li>
<li><a class="el" href="distributed__tx_8cpp_source.html">distributed_tx.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecbdc.html">cbdc</a></li><li class="navelem"><a class="el" href="namespacecbdc_1_1coordinator.html">coordinator</a></li><li class="navelem"><a class="el" href="classcbdc_1_1coordinator_1_1distributed__tx.html">distributed_tx</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
